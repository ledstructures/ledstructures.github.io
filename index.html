<!DOCTYPE html>
<html>
<link rel="stylesheet" href="style/style.css">

<head>
    <title>Winch controller configurator</title>
    <link rel="icon" type="image/x-icon" href="img/favicon_32x32.png">
</head>

<body>
    <div class="title">
        <p class="title"><a href="https://www.ledstructures.com/" target="_blank" class="title">Winch controller
                configurator</a></p>
    </div>
    <div class="contentdiv">

        <table>
            <tr>
                <td>
                    <p class=" table_paragraph"> Parameter</p>
                </td>
                <td>
                    <p class="table_paragraph">New values</p>
                </td>
                <td>
                    <p class="table_paragraph">Metrics
                    </p>
                    <i class="metrics_help">&#x1F6C8;</i>
                    <span class="metrics_hide">Numbers below are approximations.</span>
                </td>

                <td>
                    <p class="table_paragraph">Current values</p>
                </td>
            </tr>
            <tr>
                <td>
                    <p class="table_paragraph"> Addresses:</p>
                </td>
                <td>
                    Address auto from A: <input type="checkbox" id="AddrAutomatic" checked="false"
                        onchange="changeCatchAll();">
                </td>
                <td></td>
            </tr>
            <tr>
                <td>A address</td>
                <td> <input id="NewAddrA" type="number" min="1" max="512" onchange="changeCatchAll();" />
                    <p class="isOK" id="NewAddrAisOK"></p>
                </td>
                <td> </td>

                <td>
                    <p id="CurrAddrAeq" class="isEq"></p>
                    <p id="CurrAddrA"></p>
                </td>
            </tr>

            <tr>
                <td>B address</td>
                <td> <input id="NewAddrB" type="number" min="1" max="512" onchange="changeCatchAll();" />
                    <p class="isOK" id="NewAddrBisOK"></p>
                </td>
                <td></td>

                <td>
                    <p id="CurrAddrBeq" class="isEq"></p>
                    <p id="CurrAddrB"></p>
                </td>
            </tr>

            <tr>
                <td>C address</td>
                <td> <input id="NewAddrC" type="number" min="1" max="512" onchange="changeCatchAll();" />
                    <p class="isOK" id="NewAddrCisOK"></p>
                </td>
                <td></td>

                <td>
                    <p id="CurrAddrCeq" class="isEq"></p>
                    <p id="CurrAddrC"></p>
                </td>
            </tr>

            <tr>
                <td>D address</td>
                <td> <input id="NewAddrD" type="number" min="1" max="512" onchange="changeCatchAll();" />
                    <p class="isOK" id="NewAddrDisOK"></p>
                </td>
                <td></td>

                <td>
                    <p id="CurrAddrDeq" class="isEq"></p>
                    <p id="CurrAddrD"></p>
                </td>
            </tr>

            <tr>
                <td>Safety address</td>
                <td> <input id="NewSaftyAddr" type="number" min="1" max="510" onchange="changeCatchAll();" />
                    <p class="isOK" id="NewAddrSisOK"></p>
                </td>
                <td></td>
                <td>
                    <p id="CurrSaftyAddreq" class="isEq"></p>
                    <p id="CurrSaftyAddr"></p>
                </td>
            </tr>
            <tr>
                <td>
                    <p class="table_paragraph"> Deviation:</p>
                    <i class="deviation_help">&#x1F6C8;</i>
                    <span class="deviation_hide">The maximum deviation
                        <br>between winch x and y
                        <br> a winch is allowed before the
                        <br> controller starts to limit.
                    </span>
                </td>
                <td></td>
                <td>
                    <p id="RWVcentimeters" class="table_metrics"></p>
                </td>
            </tr>

            <tr>
                <td>B max Deviation</td>
                <td> <input id="NewDevB" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVDevB"></p>
                </td>

                </td>
                <td>
                    <p id="CurrDevBeq" class="isEq"></p>
                    <p id="CurrDevB"></p>
                </td>
            </tr>

            <tr>
                <td>C max Deviation</td>
                <td> <input id="NewDevC" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVDevC"></p>
                </td>
                <td>

                    <p id="CurrDevCeq" class="isEq"></p>
                    <p id="CurrDevC"></p>
                </td>
            </tr>

            <tr>
                <td>D max Deviation</td>
                <td> <input id="NewDevD" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVDevD"></p>
                </td>
                <td>
                    <p id="CurrDevDeq" class="isEq"></p>
                    <p id="CurrDevD"></p>
                </td>
            </tr>

            <tr>
                <td>
                    <p class="table_paragraph">Trim / endpoints: </p>
                    <i class="deviation_help">&#x1F6C8;</i>
                    <span class="deviation_hide">The position a winch is
                        <br> always forced between.
                        <br> Is determend after deviation.

                    </span>
                </td>
                <td></td>
                <td>
                    <p class="table_metrics">Trim: from winch downward</p>
                </td>
            </tr>

            <tr>
                <td>Upper end</td>
                <td> <input id="NewUp" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVup"></p>
                </td>
                <td>
                    <p id="CurrUpeq" class="isEq"></p>
                    <p id="CurrUp"></p>
                </td>
            </tr>

            <tr>
                <td>Lower end</td>
                <td> <input id="NewDown" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVdown"></p>
                </td>
                <td>
                    <p id="CurrDowneq" class="isEq"></p>
                    <p id="CurrDown"></p>
                </td>
            </tr>

            <tr>
                <td>Upper end CD</td>
                <td> <input id="NewUpCD" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVupCD"></p>
                </td>

                <td>
                    <p id="CurrUpCDeq" class="isEq"></p>
                    <p id="CurrUpCD"></p>
                </td>
            </tr>

            <tr>
                <td>Lower end CD</td>
                <td> <input id="NewDownCD" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVdownCD"></p>
                </td>

                <td>
                    <p id="CurrDownCDeq" class="isEq"></p>
                    <p id="CurrDownCD"></p>
                </td>
            </tr>

            <tr>
                <td>
                    <p class="table_paragraph">Line <br>position: </p>
                    <i class="line_help">&#x1F6C8;</i>
                    <span class="line_hide">Position as an integer
                        <br> between 0-255 where the winch is placed
                        <br> on a ragne where a = 0, c/d = 255.
                        <br> Example, distance between a and c is
                        <br> 3 meter, b is placed at 1 meter from A,
                        <br> so b line pos should be 300cm/255*100 = 85.
                    </span>
                </td>
                <td></td>
                <td>
                    <p class="table_metrics">A=0 -> last=1</p>
                </td>
            </tr>
            <tr>
                <td>B line position: </td>
                <td> <input id="NewPosB" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVposB"></p>
                </td>
                <td>
                    <p id="CurrPosBeq" class="isEq"></p>
                    <p id="CurrPosB"></p>
                </td>
            </tr>

            <tr>
                <td>C line position</td>
                <td> <input id="NewPosC" type="number" min="0" max="255" onchange="changeCatchAll();" />
                </td>
                <td>
                    <p id="RWVposC"></p>
                </td>
                <td>
                    <p id="CurrPosCeq" class="isEq"></p>
                    <p id="CurrPosC"></p>
                </td>
            </tr>
            <tr>
                <td>
                    <p class="table_paragraph">Mode: </p>
                    <i class="mode_help">&#x1F6C8;</i>
                    <span class="mode_hide">Modes:
                        <br> Square triangle: all winches can only max deviate from a.
                        <br> Flex line: Winch b can max deviate from a, c from b etc.
                        <br> pair ab & c&d: winch winch b follow winch a, d follows c.
                        <br> 3 inline: winch b is calculated in line position between a and c.
                        <br> 4 inline: winch b and c are calculated in line position between a and d.
                    </span>
                </td>
                <td class="radiob">
                    <form id="NewMode" onchange="changeCatchAll();">
                        <input type="radio" name="mode" id="LIFOLLOWA" checked="true">Square, triangle etc.<br>
                        <input type="radio" name="mode" id="LIFOLLOWPREV">flex line<br>
                        <input type="radio" name="mode" id="LIDUBBLEPAIR">Pair a&b, c&d<br>
                        <input type="radio" name="mode" id="LI3INLINE">3 in line<br>
                        <input type="radio" name="mode" id="LI4INLINE">4 in line<br>
                    </form>
                </td>
                <td></td>
                <td>
                    <!-- display current mode -->
                    <p id="CurrModeeq" class="isEq"></p>
                    <p id="CurrMode"></p>

                </td>
            </tr>


            <tr>
                <td>
                    <p class="table_paragraph">Type:</p>
                </td>
                <td class="radiob">
                    <form id="NewType" onchange="changeCatchAll();">
                        <input type="radio" name="type" id="TYORBISFLY5">Orbisfly 5ch<br>
                        <input type="radio" name="type" id="TYORBISFLY9" checked="true">Orbisfly 9ch<br>
                        <input type="radio" name="type" id="TYDLB">DLB<br>
                    </form>
                </td>
                <td></td>
                <td>
                    <!-- display current type -->
                    <p id="CurrTypeeq"></p>
                    <p id="CurrType"></p>

                </td>
            </tr>
            <tr>
                <td>
                    <p class="table_paragraph">Name:</p>
                </td>
                <td>
                    <input id="NewName" type="text" maxlength="8" onchange="changeCatchAll();" />
                </td>
                <td></td>
                <td>
                    <p id="CurrNameeeq"></p>
                    <p id="CurrName"></p>
                </td>
            </tr>
            <tr>
                <td>
                    <input type="button" class="button" onclick="connect();" value="Connect" id="btnCon">
                    <!-- <input type="button" onclick="alert('Connect')" value="Connect"> -->
                </td>
                <td>
                    <!-- <input type="button" onclick="webserial.sendSerial('kaas');" value="Send new values"> -->
                    <input type="button" class="button" onclick="setDataSer();" value="Upload to device" id="btnSend">
                    <!-- <input type="button" onclick="wsender.setAllData(winchNew)" value="Send new values"> -->
                </td>
                <td>
                    <input type="button" class="button" onclick="cpyFromCurrent();" value="Copy from device"
                        id="btnCpy">
                </td>
                <td class="nexto_button">
                    Serial number:
                </td>
            </tr>
            <tr>
                <td >
                    <input type="button" class="button"
                        onclick="incrementAddresses(winchNew, increment, document.getElementById('AddrIncrementSafety').checked)"
                        value="Increment addresses">
                <td class="nexto_button"> 
                    <input id="AddrIncrement" type="number" min="1" max="512" onchange="changeCatchAll();" />
                </td>
                <td  class="nexto_button">
                    Increment safety: <input type="checkbox" id="AddrIncrementSafety" checked="true"
                        onchange="changeCatchAll();">
                </td>
                <td>
                    <p>
                    <p id="CurrSer"></p>
                    </p>
                </td>
            </tr>
        </table>
        <br>
        <p class="footer">2023 LedKinetic</p>
        <p class="footer">uses a <a
                href="https://github.com/guuuuus/guuuuus.github.io/blob/main/js/webserial.js">modified</a> version of
            <a href="https://github.com/tigoe/html-for-conndev/blob/main/webSerial/webserial.js">this</a>
            webSerial wrapper
        </p>
    </div>
    <script src="./js/winch.js"></script>
    <script src="./js/webserial.js"></script>
    <script src="./js/main.js"></script>

</body>